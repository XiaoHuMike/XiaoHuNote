(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{309:function(t,e,a){"use strict";a.r(e);var n=a(14),_=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"pg锁表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pg锁表"}},[t._v("#")]),t._v(" PG锁表")]),t._v(" "),e("p",[t._v("--看state和wait_event_type列，state为‘lock’或‘active’，wait_event_type为‘lock’\nselect * from pg_stat_activity")]),t._v(" "),e("p",[t._v("--查询锁表语句和 pid：\nselect pid, query from pg_stat_activity where datname='smomdb' and wait_event_type = 'Lock';")]),t._v(" "),e("p",[t._v("--杀掉select锁\nselect pg_cancel_backend('进程pid');该语句可以把锁住的进程杀掉。\n--杀掉UML锁 更新删除插入\nSELECT pg_terminate_backend('107187');")]),t._v(" "),e("p",[t._v("--通过 sql 语句拼装可以方便的把所有进程号封装起来，进而进行批量解\nselect 'select pg_cancel_backend( '''|| pid ||''');' pid from pg_stat_activity where datname='smomdb' and wait_event_type ='Lock';")]),t._v(" "),e("p",[t._v("--稍微看看\nselect * from pg_locks")])])}),[],!1,null,null,null);e.default=_.exports}}]);